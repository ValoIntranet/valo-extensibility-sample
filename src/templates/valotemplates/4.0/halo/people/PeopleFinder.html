<content id="metadata" type="x-handlebars-metadata">
  {
    "fields": ["FirstName","LastName", "JobTitle", "Department", "WorkPhone", "MobilePhone", "WorkEmail", "BaseOfficeLocation", "PictureURL", "AccountName", "OriginalPath"],
    "query": "(Title:{searchTerms} OR XRANK(cb=10) PreferredName:\" {searchTerms}\" OR WorkPhone:{searchTerms} OR MobilePhone:{searchTerms} OR WorkEmail:{searchTerms} OR JobTitle:{searchTerms} OR Department:{searchTerms} OR OfficeNumber:{searchTerms}) AND (-PreferredName:\"_spo*\" -PreferredName:\"app@*\" -PreferredName:\"Foreign Principal*\" -PreferredName:\"spsearch\" -\"sps-usertype\":1)",
    "sourceId": "b09a7990-05ea-4af9-81ef-edfab16c4e31",
    "totalResults": 1,
    "resources": [
      {
        "key": "empty",
        "values": {
          "default": "n/a"
        }
      }
    ],
    "parameters": [
      {
        "name": "ShowMoreTitle",
        "value": "Read more",
        "description": "Title for show more link"
      },
      {
        "name": "ShowMoreUrl",
        "value": "",
        "description": "Url for show more link"
      },
      {
        "name": "ShowMoreTarget",
        "value": "_blank",
        "description": "Target for show more link"
      }
    ]
  }
</content>

<content id="template" type="x-handlebars-template">
  <div class="ms-Grid valo-people-finder">
    <div class="ms-Grid-row vm-Cards valo-people-finder__list">
      {{#if dsData.items}}
        <div class="halo-cardTilesContainer">
          {{#each dsData.items}}
            {{setVariable "elementId" (generateId)}}
            <div id="id-{{@root.elementId}}"><valo-compact-people-profile-card item="{{ json this }}" /></div>
          {{/each}}
        </div>
      {{/if}}
      <!-- dsData.items - results set is ready but no data is available -->
      {{#if (isDataSetIsEmpty dsData)}}
        {{resourceLabel "NoResultsFound"}}
      {{/if}}
    </div>

    {{#if paging}}
      <nav class="valo-wp-pagination" aria-label="pagination">
          <a class="valo-wp-pagination__page-step valoPaginationPrevPage" href="javascript:;" aria-label="{{resourceLabel 'myToolsPagingPreviousTitle'}}"><i class="ms-Icon ms-Icon--ChevronLeft" aria-hidden="true"></i></a>
          <a class="valo-wp-pagination__page-step valoPaginationNextPage" href="javascript:;" aria-label="{{resourceLabel 'myToolsPagingNextTitle'}}"><i class="ms-Icon ms-Icon--ChevronRight" aria-hidden="true"></i></a>
      </nav>
    {{/if}}
    {{#if parameters.ShowMoreUrl}}
      <div class="valo-showMore">
        <a href="{{parameters.ShowMoreUrl}}" target="{{parameters.ShowMoreTarget}}">{{parameters.ShowMoreTitle}}</a>
      </div>
    {{/if}}
  </div>
</content>
